# frozen_string_literal: true

class RemoveMalwareBlob
  include ServicePattern

  attr_reader :upload

  def initialize(upload:)
    @upload = upload
  end

  def call
    return unless upload.scan_result_suspect?

    upload.attachment.purge
  end
end
