# frozen_string_literal: true

class FetchMalwareScanResultsJob < ApplicationJob
  def perform
    Upload
      .malware_scan_pending
      .where("created_at < ?", 5.minutes.ago)
      .find_each { |upload| FetchMalwareScanResult.call(upload:) }
  end
end
