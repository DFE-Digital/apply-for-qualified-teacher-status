# frozen_string_literal: true

class UpdateMalwareScanResultJob < ApplicationJob
  discard_on ActiveRecord::RecordNotFound

  def perform(upload)
    FetchMalwareScanResult.call(upload:)

    # This will ensure the job is automatically retried.
    raise StillPending if upload.malware_scan_pending?
  end

  class StillPending < StandardError
  end
end
