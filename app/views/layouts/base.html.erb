<!DOCTYPE html>
<html lang="en" class="govuk-template">
  <head>
    <meta charset="utf-8">
    <title><%= [yield(:page_title).presence, t('service.name')].compact.join(' - ') %></title>

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= tag :meta, name: 'viewport', content: 'width=device-width, initial-scale=1' %>
    <%= tag :meta, property: 'og:image', content: asset_path('images/govuk-opengraph-image.png') %>
    <%= tag :meta, name: 'theme-color', content: '#0b0c0c' %>
    <%= favicon_link_tag asset_path('images/favicon.ico') %>
    <%= favicon_link_tag asset_path('images/govuk-mask-icon.svg'), rel: 'mask-icon', type: 'image/svg', color: "#0b0c0c" %>
    <%= favicon_link_tag asset_path('images/govuk-apple-touch-icon.png'), rel: 'apple-touch-icon', type: 'image/png' %>
    <%= favicon_link_tag asset_path('images/govuk-apple-touch-icon-152x152.png'), rel: 'apple-touch-icon', type: 'image/png', size: '152x152' %>
    <%= favicon_link_tag asset_path('images/govuk-apple-touch-icon-167x167.png'), rel: 'apple-touch-icon', type: 'image/png', size: '167x167' %>
    <%= favicon_link_tag asset_path('images/govuk-apple-touch-icon-180x180.png'), rel: 'apple-touch-icon', type: 'image/png', size: '180x180' %>

    <%= stylesheet_link_tag "application" %>
    <%= javascript_include_tag "application", defer: true %>
  </head>

  <body class="govuk-template__body">
    <script>
      document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');
    </script>

    <%= govuk_skip_link %>

    <%= govuk_header(homepage_url: "https://ww.gov.uk", service_name: t('service.name'), classes: "app-header--#{HostingEnvironment.name}") do |header| %>
      <% case try(:current_namespace) %>
      <% when 'support' %>
        <% header.navigation_item(
          text: "Features",
          href: support_interface_features_path,
          active: current_page?(support_interface_features_path)
        ) %>
        <% header.navigation_item(
          text: "Countries",
          href: support_interface_countries_path,
          active: current_page?(support_interface_countries_path)
        ) %>
        <% header.navigation_item(
          text: "Sidekiq",
          href: support_interface_sidekiq_web_path
        ) %>
      <% end %>
    <% end %>

    <% if HostingEnvironment.phase %>
      <div class="govuk-width-container">
        <div class="govuk-phase-banner">
          <p class="govuk-phase-banner__content">
            <strong class="govuk-tag govuk-phase-banner__content__tag app-environment-tag--<%= HostingEnvironment.name %>">
              <%= HostingEnvironment.phase %>
            </strong>
            <span class="govuk-phase-banner__text">
              <%= HostingEnvironment.phase_text %>
            </span>
          </p>
        </div>
      </div>
    <% end %>

    <div class="govuk-width-container">
      <%= govuk_back_link(href: yield(:back_link_url)) unless yield(:back_link_url).blank? %>
      <main class="govuk-main-wrapper" id="main-content" role="main">
        <%= render(FlashMessageComponent.new(flash: flash)) %>
        <%= content_for?(:content) ? yield(:content) : yield %>
      </main>
    </div>

    <%= govuk_footer(
      meta_items_title: 'Footer links',
      meta_items: {
        'Accessibility': '/accessibility',
        'Cookies': '/cookies',
        'Privacy': '/privacy',
      }) %>
  </body>
</html>
