<% content_for :page_title, "#{"Error: " if @upload_form.errors.any?}Upload a document" %>
<% content_for :back_link_url, back_history_path(default: teacher_interface_application_form_path) %>

<%= render "upload_timeout_error" if @upload_form.timeout_error %>

<% if @document.uploads.empty? %>
  <% if @document.identification? %>
    <h1 class="govuk-heading-l">Upload a valid identification document</h1>

    <p class="govuk-body">The document must show your date of birth and your nationality. If your ID document has several pages, you can add them on the next screen. </p>

    <p class="govuk-body">Acceptable documents include:</p>

    <ul class="govuk-list govuk-list--bullet">
      <li>passport</li>
      <li>driving licence</li>
      <li>identity card</li>
      <li>birth certificate</li>
    </ul>

    <p class="govuk-hint">If you’re uploading an identity card or driving licence, you’ll need to upload both sides of the card.</p>

  <% elsif @document.name_change? %>
    <h1 class="govuk-heading-l">Upload proof of your change of name</h1>

    <p class="govuk-body">We need to see proof of your change of name.</p>

    <p class="govuk-body">For example:</p>

    <ul class="govuk-list govuk-list--bullet">
      <li>a marriage or civil partnership certificate</li>
      <li>proof that you’ve legally changed your name for another reason.</li>
    </ul>
  <% elsif @document.medium_of_instruction? %>
    <h1 class="govuk-heading-l">Upload your Medium of Instruction (MOI)</h1>
    <p class="govuk-body">This document must confirm that the primary language used to teach this qualification was English.</p>
  <% elsif @document.english_language_proficiency? %>
    <h1 class="govuk-heading-l">Upload your English language proficiency test</h1>
    <p class="govuk-body">This document must confirm that you have an English language proficiency test from an approved provider at level B2 of the Common European Framework of Reference for Languages (CEFR) scale.</p>
    <p class="govuk-body">The test must be on the list of approved English language proficiency tests and awarded within the last 2 years before the date of your application.</p>
    <%= render "shared/english_language_approved_providers", reduced_evidence_accepted: @application_form.reduced_evidence_accepted %>
  <% elsif @document.written_statement? %>
    <span class="govuk-caption-l">Proof that you’re recognised as a teacher</span>
    <h1 class="govuk-heading-l">Upload your written statement</h1>

    <% if @application_form.region.country.code == "GB-NIR" %>
      <p class="govuk-body">
        If you’ve already completed an induction period in Northern Ireland, you can provide evidence by uploading a ‘Letter of Successful Completion of Induction’ from the school where you did your induction period.
      </p>

      <p class="govuk-body">
        It must confirm that you completed your induction in Northern Ireland and show the completion date, as well as your Teacher Reference (TR) number (if you have one). It must also include the name of the school and the signature of the administration department or headteacher/principal.
      </p>

      <%= govuk_details(summary_text: "How to get this") do %>
        <p class="govuk-body">You can get a Letter of Successful Completion of Induction by contacting the school where you completed your induction period.</p>
      <% end %>

      <p class="govuk-body">
        If you did not complete an induction period, or you do not have a letter, check the box below and select ‘Continue’.
      </p>

      <%= govuk_inset_text do %>
        <p class="govuk-body">
          Note that if you cannot show evidence that you’ve already completed an induction period in Northern Ireland, if you’re awarded QTS you’ll need to do a period of statutory induction.
        </p>
      <% end %>
    <% else %>
      <p class="govuk-body">
        You need to provide a written statement from <span lang="<%= @application_form.region.country.code %>"><%= region_teaching_authority_name(@application_form.region) %></span>.
      </p>

      <p class="govuk-body">
        This is called <%= region_certificate_phrase(@application_form.region) %>.
      </p>

      <p class="govuk-body govuk-!-font-weight-bold">
        You must supply the exact type of document named here. We cannot accept any other document as proof that you’re recognised as a teacher.
      </p>

      <p class="govuk-body">Your documents must be written in English. If they are not written in English, you will need to upload a certified translation of each.</p>

      <p class="govuk-body">It must confirm:</p>
      <ul class="govuk-list govuk-list--bullet">
        <%- proof_of_recognition_requirements_for(region: @application_form.region).each do |requirement| %>
          <li><%= requirement %></li>
        <%- end -%>
      </ul>
      <p class="govuk-body">This written confirmation must be dated within 6 months of you applying for QTS.</p>

      <% if @application_form.region.status_check_written? %>
        <% if @application_form.region.teaching_authority_status_information.present?%>
          <%= raw GovukMarkdown.render(@application_form.region.teaching_authority_status_information) %>
        <% end %>

        <% if @application_form.region.country.teaching_authority_status_information.present?%>
          <%= raw GovukMarkdown.render(@application_form.region.country.teaching_authority_status_information) %>
        <% end %>
      <% end %>

      <% if @application_form.region.sanction_check_written? %>
        <% if @application_form.region.teaching_authority_sanction_information.present?%>
          <%= raw GovukMarkdown.render(@application_form.region.teaching_authority_sanction_information) %>
        <% end %>
        <% if @application_form.region.country.teaching_authority_sanction_information.present?%>
          <%= raw GovukMarkdown.render(@application_form.region.country.teaching_authority_sanction_information) %>
        <% end %>
      <% end %>

      <%= govuk_details(summary_text: "How to get this") do %>
        <p class="govuk-body">If you do not have this yet, you can obtain it by contacting:</p>
        <%= render "shared/teaching_authority_contact_information", region: @application_form.region %>
      <% end %>
    <% end %>
  <% elsif @document.qualification_certificate? %>
    <span class="govuk-caption-l"><%= I18n.t("application_form.tasks.sections.qualifications") %></span>

    <h1 class="govuk-heading-l">
      <% if @document.documentable.try(:institution_name).present? %>
        Upload your <%= @document.documentable.institution_name %> <%= I18n.t("document.document_type.qualification_certificate") %>
      <% elsif @document.documentable.is_teaching_qualification? %>
        Upload your teaching qualification certificate
      <% else %>
        Upload your university degree certificate
      <% end %>
    </h1>

    <div class="govuk-body">Your documents must be written in English. If they are not written in English, you will need to upload a certified translation of each.</div>
  <% elsif @document.qualification_transcript? %>
    <span class="govuk-caption-l"><%= I18n.t("application_form.tasks.sections.qualifications") %></span>

    <h1 class="govuk-heading-l">
      <% if @document.documentable.try(:institution_name).present? %>
        Upload your <%= @document.documentable.institution_name %> <%= I18n.t("document.document_type.qualification_transcript") %>
      <% elsif @document.documentable.is_teaching_qualification? %>
        Upload your teaching qualification transcript
      <% else %>
        Upload your university degree transcript
      <% end %>
    </h1>

    <p class="govuk-body"><%= I18n.t("application_form.qualifications.upload.transcript.description") %></p>
  <% elsif @document.qualification_document? %>
    <h1 class="govuk-heading-l">Upload your qualification document</h1>
  <% end %>
<% else %>
  <h1 class="govuk-heading-l">Upload the next page of your <%= I18n.t("document.document_type.#{@document.document_type}") %> document</h1>
  <p class="govuk-body">Upload the next page of your <%= I18n.t("document.document_type.#{@document.document_type}") %> document. If your document has more pages, you can add them on the next screen.</p>
<% end %>

<%= form_with model: @upload_form, url: [:teacher_interface, :application_form, @document, :uploads] do |f| %>
  <%= f.govuk_error_summary %>

  <% if @document.optional? %>
    <%= f.govuk_check_boxes_fieldset :do_not_have_document, multiple: false, legend: nil do %>
      <%= f.govuk_check_box :do_not_have_document, 1, 0, multiple: false, link_errors: true, label: { text: "I do not have #{region_certificate_phrase(@application_form.region)}.".html_safe }%>
    <% end %>
  <% end %>

  <%= f.govuk_file_field :original_attachment,
                         label: { text: "Select a file to upload", class: "govuk-heading-m" },
                         hint: { text: "You can upload your files in PDF, JPG, PNG, DOCX or DOC format. Each file must be no larger than 50MB." } %>

  <% if @document.qualification_transcript? %>
    <%= govuk_details(summary_text: "What is a transcript?") do %>
      <p class="govuk-body">A transcript (or diploma supplement) is a document from the institution where you studied for your degree. It lists all the modules or subjects you studied in each year, and the marks or grades you were awarded.</p>
    <% end %>
  <% end %>

  <% if @document.translatable? %>
    <%= f.govuk_radio_buttons_fieldset :written_in_english, legend: { size: "m", text: "Is your document written in English?" } do %>
      <%= f.govuk_radio_button :written_in_english, :true, label: { text: "Yes" }, link_errors: true %>

      <%= f.govuk_radio_button :written_in_english, :false, label: { text: "No, I’ll upload a certified translation as well" } do %>
        <p class="govuk-body">
          This must be a certified translation showing the translator’s signature, name, contact details and official stamp or ID number, plus the date of translation.
        </p>

        <%= f.govuk_file_field :translated_attachment,
                               label: { text: "Select a file to upload" },
                               hint: { text: "You can upload your files in PDF, JPG, PNG, DOCX or DOC format. Each file must be no larger than 50MB." } %>
      <% end %>
    <% end %>
  <% end %>

  <%= render "shared/save_submit_buttons", f: %>
<% end %>
