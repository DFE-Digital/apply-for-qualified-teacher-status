<% @staff.find_each do |staff| %>
  <h2 class="govuk-heading-m"><%= staff.name %></h2>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <%= govuk_summary_list do |summary_list|
        summary_list.with_row do |row|
          row.with_key { "User data" }    
          row.with_value { "" }
        end

        summary_list.with_row do |row|
          row.with_key { "Email address" }
          row.with_value { staff.email }
        end

        summary_list.with_row do |row|
          row.with_key { "Invited" }
          row.with_value { staff.invitation_sent_at.to_s }
        end

        summary_list.with_row do |row|
          row.with_key { "Last signed in" }
          row.with_value { staff.last_sign_in_at.to_s }
        end

        if staff.created_by_invite?
            summary_list.with_row do |row|
                row.with_key { "Invitation status" }
                row.with_value do
                if staff.invitation_accepted?
                    govuk_tag(text: "Accepted", colour: "green")
                else
                    govuk_tag(text: "Not accepted", colour: "red")
                end
                end
            end
        end
      end %>
    </div>
    <div class="govuk-grid-column-one-third">
      <div class="govuk-!-padding-top-2 govuk-!-text-align-centre">
        <%= govuk_link_to("Change permissions", edit_assessor_interface_staff_path(staff)) %>
      </div>
    </div>
  </div>

  <%= govuk_table(classes: "change-permissions") do |table|
    table.with_head do |head|
      head.with_row do |row|
        row.with_cell(header: true, text: "Permissions", colspan: 8)
      end

      head.with_row do |row|
        row.with_cell(header: true, text: "Assess applications")
        row.with_cell(header: true, text: "Change names")
        row.with_cell(header: true, text: "Change work history")
        row.with_cell(header: true, text: "Reverse decisions")
        row.with_cell(header: true, text: "Support console")
        row.with_cell(header: true, text: "Verify applications")
        row.with_cell(header: true, text: "Withdraw")
        row.with_cell(header: true, text: "Manage staff")
      end
    end

    table.with_body do |body|
      body.with_row do |row|
        row.with_cell { govuk_boolean_tag(staff.assess_permission) }
        row.with_cell { govuk_boolean_tag(staff.change_name_permission) }
        row.with_cell { govuk_boolean_tag(staff.change_work_history_permission) }
        row.with_cell { govuk_boolean_tag(staff.reverse_decision_permission) }
        row.with_cell { govuk_boolean_tag(staff.support_console_permission) }
        row.with_cell { govuk_boolean_tag(staff.verify_permission) }
        row.with_cell { govuk_boolean_tag(staff.withdraw_permission) }
        row.with_cell { govuk_boolean_tag(staff.manage_staff_permission) }
      end
    end
  end %>
<% end %>
